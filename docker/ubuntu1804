FROM            ubuntu:18.04
MAINTAINER      MIT Probabilistic Computing Project

                #  Create a Python 3 environment.
RUN             apt-get update && apt-get install -y python3-venv
RUN             python3 -m venv /venv

                # Add the source code.
ADD             . /sum-product-dsl
WORKDIR         /sum-product-dsl

                # Build and test.
RUN             . /venv/bin/activate && sh requirements.sh
RUN             . /venv/bin/activate && pip install .
RUN             . /venv/bin/activate && ./check.sh tests

                # Package into source and binaries.
RUN             . /venv/bin/activate && python setup.py sdist
RUN             . /venv/bin/activate && python setup.py bdist
